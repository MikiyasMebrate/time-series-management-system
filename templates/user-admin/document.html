{% load static %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>DPMEs</title>
    <link />
    {% include 'user-admin/include/head.html' %}
  </head>

  <body class="hold-transition sidebar-mini layout-fixed">
    {% include 'user-admin/include/navbar.html'%}
    <div>{% include 'user-admin/include/sidebar.html' %}</div>

    <!--Body Start-->
    <div class="content-wrapper">


        <div class="col-lg-7 mx-auto d-block">
            {% include 'includes/messages.html' %}
          </div>


      <!-- TItle Start-->
      <div class="content-header">
        <h4 class="text-info m-3">Documents</h4>
        <div class="container-fluid">
            <div class="table-responsive bg-white p-3">
                <div class="row p-3">
          
                  <div class="col-lg-8">
                    <form>
                      <div class="col-12 d-flex align-items-center">
                        <input type="text" name="q" class="form-control ps-5 pe-5 m-3 d-block" placeholder="Enter Key Word">
                        <button class="btn btn-primary"> <i class="fas fa-search ms-2"></i></button>
                      </div>
                    </form>
                  </div>
            
            
                  <div class="col flot-right ">
                    <button class="btn btn-primary float-end m-2" data-bs-toggle="modal" data-bs-target="#AddDocument"
                      data-bs-whatever="@mdo"><i class="fas fa-plus"></i> Add Document</button>
                  </div>
            
                </div>
               <div class="table-responsive">
                <table id="allReportData" class="table" style="table-layout: fixed;" >
          
                  <tbody>
          
                          <!--Header-->
                          <tr>
                            <td class="border m-0 p-0 " colspan="3">
                              <table class="m-0 p-0 table table-bordered table-hover" style="table-layout: fixed;" >
                                <thead  name="tableHead">
                                  <tr style="background-color: #9fdfa9;" >
                                    <th  scope="col">Title (English)</th>
                                    <th  scope="col">Title (Amharic)</th>
                                    <th  scope="col">Action</th>
                                  </tr>
                                </thead >

                              </table>
                            </td>
                          </tr>

                          {% if topics%}
                          {% for topic in topics%}
                          {% if topic.get_document_lists %}
                          <!--Topic-->
                          <tr>
                            <td class="border m-0 p-0 " colspan="3">
                              <table class="m-0 p-0 table table-bordered table-hover" style="table-layout: fixed;" >
                                <thead  name="tableHead">
                                  <tr style="background-color: #40864b;" ><th class="text-light" colspan="3">(Topic) {{topic.title_ENG}}</th></tr>
                                </thead >
                               
                                <tbody name="tableBody">
                                  {% for document in topic.get_document_lists%}
                                  <tr>
                                    <td>{{document.title_ENG}}</td>
                                    <td>{{document.title_AMH}}</td>
                                    <td>
                                      <a href="/media/{{document.file}}" target="_blank" class="btn btn-outline-success mt-2 btn-sm btn-edit">
                                        <i class="fa fa-eye"></i>
                                      </a>
                                      <a download="/media/{{document.file}}" href="/media/{{document.file}}" class="btn btn-outline-success mt-2 btn-sm btn-edit">
                                        <i class="fa fa-download"></i>
                                      </a>
                                      <a href="{% url 'document_edit' document.id %}" class="btn btn-outline-info mt-2 btn-sm btn-edit">
                                        <i class="fa fa-edit"></i>
                                      </a>
                                      <button class="btn btn-outline-danger mt-2 btn-sm btn-delete" data-bs-toggle="modal" data-bs-target="#deleteDocumentModal" data-bs-whatever="@mdo" data-id={{document.id}}
                                        data-name={{document.title_ENG}}>
                                        <i class="fa fa-trash"></i>
                                      </button>
                                    </td>
                                  </tr>
                                  {% endfor %}
                                </tbody>
                              </table>
                            </td>
                          </tr>
                          {% endif %}
                          {% endfor %}
                          {% endif %}


                          
          
          
                          
          
          
                  </tbody>
          
                </table>
               </div>
              </div>          
        </div>
      </div>
      <!--Title End-->
    </div>
    <!--Body End-->


    <!--add document modal-->
    <div class="modal fade" id="AddDocument" tabindex="-1" aria-labelledby="AddDocumentLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="AddDocumentLabel">Documents</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <form method="POST" enctype="multipart/form-data">
                      {% csrf_token %}

                      <div class="modal-body">
                         {{form.as_p}}
                      </div>

                      <div class="modal-footer">
                           <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                           <button type="submit" class="btn btn-primary">Yes</button>
                      </div>

                  </form>
                </div>
        </div>
    </div>
    
    
    <!--delete documents modal-->
        <!--Delete  Modal-->
    <!-- Modal -->
    <div class="modal fade" id="deleteDocumentModal" tabindex="-1" aria-labelledby="deleteDocumentModalLabel"
      aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="deleteDocumentModalLabel">Delete Topic</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p class="h4 fw-normal" id="deleteTopic"></p>
          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <a href="#" id="deleteTopicAnchor" type="submit" class="btn btn-danger">Delete</a>
          </div>

        </div>
      </div>
    </div>
    <!--End Modal -->


    {% include 'user-admin/include/footer.html'%}

    <!--Chart -->
    <script src="{% static 'assets/plugins/jquery-ui/jquery-ui.min.js' %}"></script>
    <script src="{% static 'assets/plugins/chart.js/Chart.min.js' %}"></script>
    <script src="{% static 'assets/plugins/jquery-knob/jquery.knob.min.js' %}"></script>
    <script src="{% static 'assets/plugins/moment/moment.min.js' %}"></script>
    <script src="{% static 'assets/plugins/daterangepicker/daterangepicker.js' %}"></script>
    <script src="{% static 'assets/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/summernote/summernote-bs4.min.js' %}"></script>
    <script src="{% static 'assets/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js' %}"></script>

    {% include 'user-admin/include/footer_js.html'%}

    <script>
      //Event handler that handle on Click to delete
    $(".btn-delete").on('click', function () {
    
    const buttonData = $(this).data()
    $("#deleteTopicAnchor").attr("href", `/user-admin/document_delete/${buttonData.id}`)
    $("#deleteTopic").html(`Are you sure you want to delete <div> <code> ${buttonData.name}</code>? </div> `)
    })


    </script>
  </body>
</html>
